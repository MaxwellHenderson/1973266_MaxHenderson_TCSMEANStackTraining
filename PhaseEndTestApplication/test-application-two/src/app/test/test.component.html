<!-- Format of the FormControl hierarchy
    FormGroup formHolder
        FormArray questions
            FormGroup dynamically allocated name (a number generated by a for loop, so question1, question2, question3...)
                FormControl also dynamically allocated. This is used to hold the radioButton refernce
 -->


<div>
    <h1>Test</h1>
    <!-- This formGroup only holds teh FormArray questions. It doesn't do anything else. -->
    <form [formGroup]="formHolder!" (ngSubmit)="checkAnswers()">
        <!-- This just tells me if the form is valid -->
        {{formHolder.status}}
        <!-- This ngFor goes into the formHolder, grabs the stored FormArray questions, and then
                loops through that to create quesitons in the form of cards-->
        <!-- I had some issues with it not recognizing 'questions' as a FormArray when
                I would ask it to loop thorugh the 'controls' parameter. That is because
                the fields of a FormGroup by default evaluate to a AbstractControl. The
                'value' property of an AbstractControl is the 'controls' property
                if the AbstractControl is actually a FormArray-->
        <div class="container" formArrayName="questions"
            *ngFor="let question of formHolder?.get('questions')?.value; let i=index;">
            <div class="card">
                <div class="card-body">
                    <!-- The value 'i' throughout this is used as an indexing value. Because my
                    FormControl elements and questions list are created dynamically, I
                    name them dynamically. -->
                    <!-- quesionsList is an array of objects representing the test
                            questions with the fields
                            - question
                            - option1
                            - option2
                            - option3
                            - option4
                            - correctAnswer -->
                    <!-- I am able to use the indexing to access the correct question for
                        each card -->
                    <h3 class="card-title">{{questionsList[i].question}}</h3>
                    <div [formGroupName]="i">
                        <div class="form-check">
                            <!-- Use the index to grab the proper question text
                                from the question array of objects -->
                            <label for="{{'option'+i}}">{{questionsList[i].option1}}</label>
                            <!-- The formControlName matches up with the name of the form control in 
                                the given formGroup 'i'. I checked in the debugger for that.
                                For some reason though, when I assign the formControlName so that
                                I can get the control info later, the radio buttons no longer work.
                                When I delete the formControlName and just use name instead, they work
                                as intended, grouping them by question-->
                            <input class="form-check-input" formControlName="{{'question'+i}}" name="{{'question'+i}}"
                                type="radio" value="option1" id="{{'option'+i}}">
                            <!-- This span is used when checking answers. It will label the question
                                    choice as the correct choice, the wrong choice, or point out which answer
                                    was the correct choice. -->
                            <span id="{{'question'+i+'option1'}}"></span>
                        </div>
                        <div class="form-check">
                            <label for="{{'option'+i}}">{{questionsList[i].option2}}</label>
                            <input class="form-check-input" formControlName="{{'question'+i}}" name="{{'question'+i}}"
                                type="radio" value="option2" id="{{'option'+i}}">
                            <span id="{{'question'+i+'option2'}}"></span>
                        </div>

                        <div class="form-check">
                            <label for="{{'option'+i}}">{{questionsList[i].option3}}</label>
                            <input class="form-check-input" formControlName="{{'question'+i}}" name="{{'question'+i}}"
                                type="radio" value="option3" id="{{'option'+i}}">
                            <span id="{{'question'+i+'option3'}}"></span>
                        </div>

                        <div class="form-check">
                            <label for="{{'option'+i}}">{{questionsList[i].option4}}</label>
                            <input class="form-check-input" formControlName="{{'question'+i}}" name="{{'question'+i}}"
                                type="radio" value="option4" id="{{'option'+i}}">
                            <span id="{{'question'+i+'option4'}}"></span>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </form>

    <!-- For some reason, the button calls the correct function, it goes through the form
        properly labeling the spans with 'correct' or 'incorrect', but when it
        finishes the function the spans are reset to their original empty state.
        The header for score however is properly updated. -->
    <div class="d-flex justify-content-center mr-2">
        <button (click)="checkAnswers()" [disabled]="!formHolder.valid">Submit
            Answers</button>
        <h2>
            {{score}}
        </h2>
    </div>
</div>

<!-- I have a theory that for some reason, the Angular mdf FormControl elements
    are resetting their state every time they are clicked or interacted with.
    That would explain why the radio buttons never seem to change state, and
    why the span elements get reset at the end of checking the test answers -->